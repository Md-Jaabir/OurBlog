const levels={level1,level2,level3},aiLevel={ailevel1,ailevel2,ailevel3},shotTypeCon=document.querySelector(".shot-type"),powerCon=document.querySelector(".power"),timingMeterCon=document.querySelector(".timing-meter"),ballingCon=document.querySelector(".balling-control");let indicator=document.querySelector(".indicator"),currentShotType=null,currentPower=null,currentTiming=null,isFreeHit=!1,zoneIndex=0,target=0,batters=[0,1],onStrikeBatter=batters[0],bowlerIndex=0,lastbattingIndex=1,crowd=new Audio("./assets/crowd.mp3");crowd.loop=!0,crowd.volume=.5;let currentBatting=0===parseInt(location.params.batfirst)?parseInt(location.params.team1):parseInt(location.params.team2),currentBowling=0===parseInt(location.params.batfirst)?parseInt(location.params.team2):parseInt(location.params.team1);const totalBalls=6*parseInt(location.params.overs),team1={team:teams[parseInt(location.params.team1)],run:0,wicket:0,balls:0},team2={team:teams[parseInt(location.params.team2)],run:0,wicket:0,balls:0};let currentTeamCard=team1,currentRoleCard="batting";function endMatch(){setTimeout(()=>{team1.run===team2.run?location.href=`./draw.html${location.search}&team1run=${team1.run}&team2run=${team2.run}&team1wicket=${team1.wicket}&team2wicket=${team2.wicket}&team1ball=${team1.balls}&team2ball=${team2.balls}&t1flag=${team1.team.flag}&t2flag=${team2.team.flag}&t1=${team1.team.name}&t2=${team2.team.name}`:location.href=`./short-result.html${location.search}&team1run=${team1.run}&team2run=${team2.run}&team1wicket=${team1.wicket}&team2wicket=${team2.wicket}&team1ball=${team1.balls}&team2ball=${team2.balls}`},1e3)}function updateUi(){document.querySelector(".scoreboard .run-over").innerHTML=`<img src="${team1.team.flag}" width="30" height="20" alt=""> ${team1.team.shortForm.toUpperCase()} ${team1.run}-${team1.wicket} (${Math.floor(team1.balls/6)}.${team1.balls%6})`,document.querySelector(".opp-board .run-over").innerHTML=`<img src="${team2.team.flag}" width="30" height="20" alt=""> ${team2.team.shortForm.toUpperCase()} ${team2.run}-${team2.wicket} (${Math.floor(team2.balls/6)}.${team2.balls%6})`,document.querySelector(".batters .batter1 img").src=teams[currentBatting].jersey,document.querySelector(".batters .batter2 img").src=teams[currentBatting].jersey,document.querySelector(".bowlers .bowler img").src=teams[currentBowling].jersey,document.querySelector(".batters .batter1 .name").innerHTML=`${teams[currentBatting].players[batters[0]].name.replaceAll("(C)","").replaceAll("(WK)","")} ${batters[0]===onStrikeBatter?'<span class="dash">*</span>':""}`,document.querySelector(".batters .batter2 .name").innerHTML=`${teams[currentBatting].players[batters[1]].name.replaceAll("(C)","").replaceAll("(WK)","")} ${onStrikeBatter===batters[1]?'<span class="dash">*</span>':""}`,document.querySelector(".bowlers .bowler .name").innerHTML=teams[currentBowling].players[bowlerIndex].name.replaceAll("(C)","").replaceAll("(WK)",""),document.querySelector(".batters .batter1 .score").innerHTML=`${teams[currentBatting].players[batters[0]].run} (${teams[currentBatting].players[batters[0]].ballsPlayed}) `,document.querySelector(".batters .batter2 .score").innerHTML=`${teams[currentBatting].players[batters[1]].run} (${teams[currentBatting].players[batters[1]].ballsPlayed}) `,document.querySelector(".bowlers .bowler .score").innerHTML=`${teams[currentBowling].players[bowlerIndex].runsGiven} <span class="dash"> - </span>${teams[currentBowling].players[bowlerIndex].wicket} (${Math.floor(teams[currentBowling].players[bowlerIndex].ballsDone/6)} . ${teams[currentBowling].players[bowlerIndex].ballsDone%6})  `}function pause(){document.querySelector(".pause-menu").classList.remove("hide")}function resume(){document.querySelector(".pause-menu").classList.add("hide")}function selectZone(e){document.querySelectorAll(".b-zone").forEach(e=>{e.classList.contains("active")&&e.classList.remove("active")}),document.querySelector(".zone-open-btn").classList.add("hide"),e.classList.add("active"),zoneIndex=parseInt(e.id),setTimeout(()=>{document.querySelector(".zone-selection").classList.add("hide"),document.querySelector(".bowling-meter").innerHTML+='<div class="bowling-indicator bowling-meter-ani"></div>',document.querySelector(".balling-control").classList.remove("hide"),document.querySelector(".pitch-cursor").style.top=zones[zoneIndex].top+"px",document.querySelector(".pitch-cursor").style.left=zones[zoneIndex].left+"px"},500)}function startSecondInings(){lastbattingIndex=1,batters=[0,1],onStrikeBatter=0,bowlerIndex=0,currentBatting=0===parseInt(location.params.batfirst)?parseInt(location.params.team2):parseInt(location.params.team1),currentBowling=0===parseInt(location.params.batfirst)?parseInt(location.params.team1):parseInt(location.params.team2),document.querySelector(".target-cont").style.display="none",0===parseInt(location.params.batfirst)?(currentTeamCard=team2,askToSelectBowler(),setTimeout(()=>{document.querySelector(".zone-selection").classList.remove("hide")},1e3)):(bowlerIndex=team2.team.bowlers[0],currentTeamCard=team1,document.querySelector(".balling-control").classList.add("hide"),shotTypeCon.classList.remove("hide"),document.querySelector(".scoreboard .run-over").classList.add("activeboard"),document.querySelector(".opp-board .run-over").classList.remove("activeboard")),updateUi()}function selectShotType(e){currentShotType=e,shotTypeCon.classList.add("hide"),powerCon.classList.remove("hide")}function selectPower(e){currentPower=e,powerCon.classList.add("hide"),document.querySelector(".alert").classList.remove("hide"),setTimeout(()=>{document.querySelector(".alert").classList.add("hide"),document.querySelector(".meter").innerHTML+='<div class="indicator indicator-anim"></div>',indicator=document.querySelector(".indicator"),timingMeterCon.classList.remove("hide"),setTimeout(()=>{currentTiming||selectTiming()},399)},1e3)}function rotateStrike(){onStrikeBatter=onStrikeBatter==batters[0]?batters[1]:batters[0]}function selectTiming(){if(delivery=randomElement(deliveries),indicatorLeft=window.getComputedStyle(indicator).getPropertyValue("left"),indicator.style.animation="",indicator.style.left=indicatorLeft,currentTiming=65>parseFloat(indicatorLeft)?"early":parseFloat(indicatorLeft)>64&&105>parseFloat(indicatorLeft)?"perfect":"late","nb"==delivery){team1.run+=1,teams[currentBowling].players[bowlerIndex].runsGiven+=1,teams[currentBatting].players[onStrikeBatter].ballsPlayed+=1,zoneIndex=selectRandomZone(),isFreeHit=!0,setTimeout(()=>{timingMeterCon.classList.add("hide"),shotTypeCon.classList.remove("hide"),document.querySelector(".meter").removeChild(indicator),timingMeterCon.classList.add("hide"),showCard("./assets/cards/noball.png")},1e3),updateUi();return}if("wd"==delivery){team1.run+=1,zoneIndex=selectRandomZone(),setTimeout(()=>{timingMeterCon.classList.add("hide"),shotTypeCon.classList.remove("hide"),document.querySelector(".meter").removeChild(indicator),timingMeterCon.classList.add("hide"),showCard("./assets/cards/wide.png")},1e3),updateUi();return}setTimeout(()=>{document.querySelector(".meter").removeChild(indicator),timingMeterCon.classList.add("hide");let e=randomElement(levels[team1.team.level][zoneIndex][currentShotType][currentPower][currentTiming]);isFreeHit&&1===e.wicket&&(e.run=2,e.wicket=0,e.cardPath="./assets/cards/two.png"),team1.run+=e.run,(4==e.run||6==e.run||1==e.wicket)&&(crowd.volume=1,setTimeout(()=>{crowd.volume=.5},7e3)),isFreeHit||(team1.wicket+=e.wicket),team1.balls+=e.ball,showCard(e.cardPath),teams[currentBowling].players[bowlerIndex].runsGiven+=e.run,teams[currentBowling].players[bowlerIndex].wicket+=e.wicket,teams[currentBowling].players[bowlerIndex].ballsDone+=e.ball,isFreeHit=!1,e.wicket>0&&team1.wicket<10?(lastbattingIndex++,teams[currentBatting].players[onStrikeBatter].ballsPlayed+=e.ball,batters[batters.indexOf(onStrikeBatter)]=lastbattingIndex,onStrikeBatter=lastbattingIndex):team1.wicket>=10||(teams[currentBatting].players[onStrikeBatter].run+=e.run,teams[currentBatting].players[onStrikeBatter].ballsPlayed+=e.ball),0!=team1.balls&&team1.balls%6==0&&team1.balls!=totalBalls&&(bowlerIndex=team2.team.bowlers.indexOf(bowlerIndex)+1===team2.team.bowlers.length?team2.team.bowlers[0]:team2.team.bowlers[team2.team.bowlers.indexOf(bowlerIndex)+1],rotateStrike()),(1==e.run||3==e.run)&&rotateStrike(),updateUi(),0===parseInt(location.params.batfirst)&&team1.balls<totalBalls&&team1.wicket<10?(currentShotType=null,currentPower=null,currentTiming=null,isFreeHit=!1,zoneIndex=0,shotTypeCon.classList.remove("hide"),zoneIndex=selectRandomZone()):1==parseInt(location.params.batfirst)&&(team1.balls>=totalBalls||team1.wicket>=10||team1.run>team2.run)?endMatch():1===parseInt(location.params.batfirst)&&team1.balls<totalBalls&&team1.wicket<10?(currentShotType=null,currentPower=null,currentTiming=null,isFreeHit=!1,zoneIndex=0,shotTypeCon.classList.remove("hide"),zoneIndex=selectRandomZone()):setTimeout(()=>{currentShotType=null,currentPower=null,currentTiming=null,isFreeHit=!1,zoneIndex=0,target=team1.run+1,document.querySelector(".batting-board").classList.remove("hide"),document.querySelector(".batting-board .hider").classList.add("hide"),document.querySelector(".batting-board .target-cont-opener").classList.remove("hide"),currentRoleCard="batting",showScoreCard(currentTeamCard=team1,currentRoleCard),document.querySelector(".target-cont .t1-img").src=team1.team.flag,document.querySelector(".target-cont .t2-img").src=team2.team.flag,document.querySelector(".target").innerHTML=`${team2.team.name} need ${team1.run+1} runs to win`},1e3)},1e3)}function askToSelectBowler(){document.querySelector(".bowler-selection").innerHTML='<h2 class="game-font" style="color:white;margin-bottom:30px;">SELECT A BOWLER</h2>',team1.team.bowlers.forEach(e=>{e===bowlerIndex||team1.team.players[e].ballsDone>=totalBalls/5?document.querySelector(".bowler-selection").innerHTML+=`<div class="inactive-bowler" id='b-${e}'><h3>${team1.team.players[e].name}</h3><h3 class="">${team1.team.players[e].runsGiven}<span class="dash">-</span>${team1.team.players[e].wicket} (${Math.floor(team1.team.players[e].ballsDone/6)}.${team1.team.players[e].ballsDone%6})</h3></div>`:document.querySelector(".bowler-selection").innerHTML+=`<div class="active-bowler" onclick="selectBowler(this)" id='b-${e}'><h3>${team1.team.players[e].name}</h3><h3 class="">${team1.team.players[e].runsGiven}<span class="dash">-</span>${team1.team.players[e].wicket} (${Math.floor(team1.team.players[e].ballsDone/6)}.${team1.team.players[e].ballsDone%6})</h3></div>`}),setTimeout(()=>{document.querySelector(".bowler-selection").classList.remove("hide")},600)}function fixBowlingIndicator(){let e=document.querySelector(".bowling-indicator"),t=getComputedStyle(e).getPropertyValue("top");e.classList.remove("bowling-meter-ani"),e.style.top=t,41>parseFloat(t)?(team2.run+=1,teams[currentBowling].players[bowlerIndex].runsGiven+=1,teams[currentBatting].players[onStrikeBatter].ballsPlayed+=1,isFreeHit=!0,updateUi(),currentTiming=null,currentShotType=null,currentPower=null,document.querySelector(".balling-control").classList.add("hide"),document.querySelector(".bowling-meter").removeChild(document.querySelector(".bowling-indicator")),document.querySelector(".zone-open-btn").classList.remove("hide"),showCard("./assets/cards/noball.png")):101>parseFloat(t)?(team2.run+=1,updateUi(),currentTiming=null,currentShotType=null,currentPower=null,document.querySelector(".balling-control").classList.add("hide"),document.querySelector(".bowling-meter").removeChild(document.querySelector(".bowling-indicator")),showCard("./assets/cards/wide.png"),document.querySelector(".zone-open-btn").classList.remove("hide")):(currentShotType=randomElement(aiLevel[`ai${team2.team.level}`].shotType[zoneIndex]),currentTiming=randomElement(aiLevel[`ai${team2.team.level}`].timing),currentPower=randomElement(aiLevel[`ai${team2.team.level}`].power),randScore=randomElement(levels[team2.team.level][zoneIndex][currentShotType][currentPower][currentTiming]),isFreeHit&&1===randScore.wicket&&(randScore.run=2,randScore.wicket=0,randScore.cardPath="./assets/cards/two.png"),team2.run+=randScore.run,isFreeHit||(team2.wicket+=randScore.wicket),team2.balls+=parseInt(randScore.ball),(4===randScore.run||6===randScore.run||1===randScore.wicket)&&(crowd.volume=1,setTimeout(()=>{crowd.volume=.5},7e3)),showCard(randScore.cardPath),teams[currentBowling].players[bowlerIndex].runsGiven+=randScore.run,teams[currentBowling].players[bowlerIndex].wicket+=randScore.wicket,teams[currentBowling].players[bowlerIndex].ballsDone+=randScore.ball,randScore.wicket>0&&team2.wicket<10?(teams[currentBatting].players[onStrikeBatter].ballsPlayed+=randScore.ball,lastbattingIndex++,batters[batters.indexOf(onStrikeBatter)]=lastbattingIndex,onStrikeBatter=lastbattingIndex):team2.wicket>=10||(teams[currentBatting].players[onStrikeBatter].run+=randScore.run,teams[currentBatting].players[onStrikeBatter].ballsPlayed+=randScore.ball),0!=team2.balls&&team2.balls%6==0&&team2.balls!=totalBalls&&10!=team2.wicket&&(askToSelectBowler(),rotateStrike()),(1==randScore.run||3==randScore.run)&&rotateStrike(),updateUi(),currentTiming=null,currentShotType=null,currentPower=null,isFreeHit=!1,0==parseInt(location.params.batfirst)&&team2.run<=team1.run&&team2.balls<totalBalls&&team2.wicket<10?(document.querySelector(".balling-control").classList.add("hide"),document.querySelector(".bowling-meter").removeChild(document.querySelector(".bowling-indicator")),document.querySelector(".zone-open-btn").classList.remove("hide")):1==parseInt(location.params.batfirst)&&team2.balls<totalBalls&&team2.wicket<10?(document.querySelector(".balling-control").classList.add("hide"),document.querySelector(".zone-open-btn").classList.remove("hide"),document.querySelector(".balling-control").classList.add("hide"),document.querySelector(".bowling-meter").removeChild(document.querySelector(".bowling-indicator")),document.querySelector(".zone-open-btn").classList.remove("hide")):1==parseInt(location.params.batfirst)&&(team2.balls>=totalBalls||team2.wicket>=10)?(target=team2.run+1,setTimeout(()=>{currentShotType=null,currentPower=null,currentTiming=null,isFreeHit=!1,zoneIndex=0,target=team1.run+1,document.querySelector(".batting-board").classList.remove("hide"),document.querySelector(".batting-board .hider").classList.add("hide"),document.querySelector(".batting-board .target-cont-opener").classList.remove("hide"),currentRoleCard="batting",showScoreCard(currentTeamCard=team2,currentRoleCard),document.querySelector(".target-cont .t1-img").src=team1.team.flag,document.querySelector(".target-cont .t2-img").src=team2.team.flag,document.querySelector(".target").innerHTML=`${team1.team.name} need ${team2.run+1} runs to win`},1e3)):endMatch())}function selectBowler(e){setTimeout(()=>{bowlerIndex=parseInt(e.id.replace("b-","")),updateUi(),document.querySelector(".bowler-selection").classList.add("hide"),crowd.play()},400)}function openZoneSelection(){document.querySelector(".zone-selection").classList.remove("hide")}function showCard(e){document.querySelector(".card-cont img").src=e,document.querySelector(".card-cont").style.top="0",setTimeout(()=>{document.querySelector(".card-cont").style.top="-100vh"},1e3)}function showInitialBoard(){showScoreCard(currentTeamCard,currentRoleCard),document.querySelector(".batting-board").classList.remove("hide"),document.querySelector(".pause-menu").classList.add("hide")}window.onload=()=>{document.querySelector(".t1-img").src=team1.team.flag,document.querySelector(".t2-img").src=team2.team.flag,document.querySelector(".over-count").innerHTML=`${1==parseInt(location.params.overs)?"Super over":location.params.overs+" OVER MATCH"} `,document.querySelector(".match-preview .stadium").innerHTML=`LIVE FROM ${randomElement(stadiums)} `,document.querySelector(".target-cont").style.display="none",zoneIndex=selectRandomZone(),team1.team.players.forEach((e,t)=>{team1.team.players[t]={name:e,run:0,wicket:0,ballsPlayed:0,ballsDone:0,runsGiven:0}}),team2.team.players.forEach((e,t)=>{team2.team.players[t]={name:e,run:0,wicket:0,ballsPlayed:0,ballsDone:0,runsGiven:0}}),0==location.params.batfirst?(shotTypeCon.classList.remove("hide"),bowlerIndex=team2.team.bowlers[0],currentTeamCard=team1):(askToSelectBowler(),document.querySelector(".zone-selection").classList.remove("hide"),currentTeamCard=team2),updateUi()};const showScoreCard=(e,t)=>{"batting"===t?(document.querySelector(".batting-board .team-sect img").src=`${e.team.flag}`,document.querySelector(".batting-board .team-sect h2").innerHTML=`${e.team.name}  &nbsp <br> ${e.run} <span class="dash">-</span> ${e.wicket} (${Math.floor(e.balls/6)}.${e.balls%6})`,document.querySelector(".batting-board .players").innerHTML=e.team.players.map(e=>`<div><h3 class="game-font">${e.name}</h3><h3 class="run-ball game-font">${e.run} (${e.ballsPlayed})</h3></div>`).join(""),document.querySelector(".pause-menu").classList.add("hide")):(document.querySelector(".batting-board .team-sect img").src=`${e.team.flag}`,document.querySelector(".batting-board .team-sect h2").innerHTML=`${e.team.name}<br> ( BOWLING )`,document.querySelector(".batting-board .players").innerHTML=e.team.bowlers.map(t=>`<div><h3 class="game-font">${e.team.players[t].name}</h3><h3 class="run-ball game-font">${e.team.players[t].runsGiven} <span class="dash">-</span> ${e.team.players[t].wicket} (${Math.floor(e.team.players[t].ballsDone/6)}.${e.team.players[t].ballsDone%6})</h3></div>`).join(""))},hideScoreCard=()=>{document.querySelector(".batting-board").classList.add("hide")},openTargetCont=()=>{document.querySelector(".batting-board").classList.add("hide"),document.querySelector(".batting-board .hider").classList.remove("hide"),document.querySelector(".batting-board .target-cont-opener").classList.add("hide"),document.querySelector(".target-cont").style.display="flex"},openSquads=()=>{document.querySelector(".squads").classList.remove("hide"),document.querySelector(".match-preview").classList.add("hide"),document.querySelector(".squads .team-1 img").src=`${team1.team.flag}`,document.querySelector(".squads .team-1 h2").innerHTML=`${"ipl"==location.params.mode?team1.team.shortForm:team1.team.name}`,document.querySelector(".squads .team-2 img").src=`${team2.team.flag}`,document.querySelector(".squads .team-2 h2").innerHTML=`${"ipl"==location.params.mode?team2.team.shortForm:team2.team.name}`,document.querySelector(".squads .team-1 .players").innerHTML=team1.team.players.map(e=>`<h3 class="game-font">${e.name}</h3>`).join(""),document.querySelector(".squads .team-2 .players").innerHTML=team2.team.players.map(e=>`<h3 class="game-font">${e.name}</h3>`).join("")},closeSquads=()=>{crowd.play(),console.log(crowd),document.querySelector(".squads").classList.add("hide")};function nextCard(){currentTeamCard.team.name===team1.team.name?"batting"===currentRoleCard?(currentRoleCard="bowling",showScoreCard(currentTeamCard=team1,currentRoleCard)):(currentRoleCard="batting",showScoreCard(currentTeamCard=team2,currentRoleCard)):"batting"===currentRoleCard?(currentRoleCard="bowling",showScoreCard(currentTeamCard=team2,currentRoleCard)):(currentRoleCard="batting",showScoreCard(currentTeamCard=team1,currentRoleCard))}function prevCard(){currentTeamCard.team.name===team1.team.name?"batting"===currentRoleCard?(currentRoleCard="bowling",showScoreCard(currentTeamCard=team2,currentRoleCard)):(currentRoleCard="batting",showScoreCard(currentTeamCard=team1,currentRoleCard)):"batting"===currentRoleCard?(currentRoleCard="bowling",showScoreCard(currentTeamCard=team1,currentRoleCard)):(currentRoleCard="batting",showScoreCard(currentTeamCard=team2,currentRoleCard))}